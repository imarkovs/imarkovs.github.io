\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k}{if} \PYG{o}{\PYGZti{}}\PYG{n}{isunctr}\PYG{p}{(}\PYG{n}{B}\PYG{p}{)}
  \PYG{n}{Tr} \PYG{p}{=} \PYG{n}{ell}\PYG{p}{;} \PYG{n}{wr} \PYG{p}{=} \PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n}{Tr}\PYG{p}{,} \PYG{n}{q}\PYG{p}{);}
  \PYG{n}{wp} \PYG{p}{=} \PYG{n}{B2w}\PYG{p}{(}\PYG{n}{B}\PYG{p}{,} \PYG{n}{ell}\PYG{p}{);} \PYG{n}{wf} \PYG{p}{=} \PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n}{ell}\PYG{p}{,} \PYG{n}{q}\PYG{p}{);}
  \PYG{n}{wh} \PYG{p}{=} \PYG{n}{lqctr}\PYG{p}{(}\PYG{n}{B}\PYG{p}{,} \PYG{n}{wr}\PYG{p}{,} \PYG{p}{[],} \PYG{n}{wp}\PYG{p}{,} \PYG{n}{wf}\PYG{p}{);}
  \PYG{n}{check}\PYG{p}{(}\PYG{n}{w\PYGZus{}in\PYGZus{}B}\PYG{p}{([}\PYG{n}{wp}\PYG{p}{;} \PYG{n}{wh}\PYG{p}{;} \PYG{n}{wf}\PYG{p}{],} \PYG{n}{B}\PYG{p}{))}
\PYG{k}{end}
\end{Verbatim}
